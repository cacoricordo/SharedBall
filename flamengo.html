<!DOCTYPE html>
<html>
<head>
    <title>Mesa Tática Compartilhada - Flamengo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .background-square {
            position: absolute;
            left: 20px;
            top: 20px;
            width: 600px;
            height: 300px;
            background: #16c516;
            z-index: 0;
            border-radius: 8px;
        }
        #background-line, #background-line2, #background-line3, #background-line4, #background-line5,
        #background-line6, #background-line7, #background-line8, #background-line9,
        #background-line10, #background-line11, #background-line12, #background-line13,
        #background-line14, #background-line15, #background-line16, #background-line17 {
            position: absolute;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line {left:22px;  top:22px;  width:596px; height:2px;}
        #background-line2 {left:22px; top:316px; width:596px; height:2px;}
        #background-line3 {left:22px; top:22px; width:2px; height:296px;}
        #background-line4 {left:616px; top:22px; width:2px; height:296px;}
        #background-line5 {left:308px; top:22px; width:2px; height:296px;}
        #background-line6 {left:88px; top:97px; width:2px; height:150px;}
        #background-line7 {left:58px; top:120px; width:2px; height:102px;}
        #background-line8 {left:22px; top:120px; width:36px; height:2px;}
        #background-line9 {left:22px; top:220px; width:36px; height:2px;}
        #background-line10 {left:552px; top:97px; width:66px; height:2px;}
        #background-line11 {left:22px; top:245px; width:66px; height:2px;}
        #background-line12 {left:550px; top:97px; width:2px; height:150px;}
        #background-line13 {left:580px; top:120px; width:2px; height:102px;}
        #background-line14 {left:582px; top:120px; width:36px; height:2px;}
        #background-line15 {left:582px; top:220px; width:36px; height:2px;}
        #background-line16 {left:22px; top:97px; width:66px; height:2px;}
        #background-line17 {left:552px; top:245px; width:66px; height:2px;}
        .gol-square {
            position: absolute;
            left: 10px;
            top: 135px;
            width: 10px;
            height: 70px;
            background: #ffffff;
            z-index: 0;
            border-radius: 8px;
        }
        .gol2-square {
            position: absolute;
            left: 620px;
            top: 135px;
            width: 10px;
            height: 70px;
            background: #ffffff;
            z-index: 0;
            border-radius: 8px;
        }
        .circlecentral-flamengo {
            width: 140px; height: 140px;
            background: transparent; border-radius: 50%;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-weight: bold;
            font-family: sans-serif;
            font-size: 14px;
            left: 237px;
            top: 100px;
            border: 2px solid #ffffff;
            user-select: none;
        }
        .circle-flamengo {
            width: 26px; height: 26px;
            background: #33aaff; border-radius: 50%;
            position: absolute;
            cursor: grab;
            touch-action: none;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-weight: bold;
            font-family: sans-serif;
            font-size: 14px;
            user-select: none;
        }
        /* Unique initial positions and colors for Flamengo circles, similar to index.html but with new IDs */
        #flamengo-circle1 { left: 25px; top: 160px; background: #ff33aa; }
        #flamengo-circle2 { left: 160px; top: 270px; background: #33ff88; }
        #flamengo-circle3 { left: 120px; top: 130px; background: #33ff88; }
        #flamengo-circle4 { left: 120px; top: 200px; background: #33ff88; }
        #flamengo-circle5 { left: 200px; top: 160px; background: #33ff88; }
        #flamengo-circle6 { left: 160px; top: 40px; background: #33ff88; }
        #flamengo-circle7 { left: 300px; top: 270px; background: #33ff88; }
        #flamengo-circle8 { left: 260px; top: 160px; background: #33ff88; }
        #flamengo-circle9 { left: 370px; top: 160px; background: #33ff88; }
        #flamengo-circle10 { left: 230px; top: 120px; background: #33ff88; }
        #flamengo-circle11 { left: 320px; top: 40px; background: #33ff88; }
        #flamengo-circle13 { left: 400px; top: 100px; background: #ff3333; }
        #flamengo-circle14 { left: 410px; top: 200px; background: #ff3333; }
        #flamengo-circle15 { left: 500px; top: 120px; background: #ff3333; }
        #flamengo-circle16 { left: 520px; top: 260px; background: #ff3333; }
        #flamengo-circle17 { left: 600px; top: 160px; background: #ff3333; }
        #flamengo-circle18 { left: 570px; top: 40px; background: #ff3333; }
        #flamengo-circle19 { left: 470px; top: 250px; background: #ff3333; }
        #flamengo-circle20 { left: 500px; top: 160px; background: #ff3333; }
        #flamengo-circle21 { left: 420px; top: 160px; background: #ff3333; }
        #flamengo-circle22 { left: 580px; top: 120px; background: #ff3333; }
        #flamengo-circle23 { left: 520px; top: 40px; background: #ff3333; }
        #flamengo-circle24 { left: 308px; top: 160px; background: #ffffff; }
        body { margin: 0; overflow: hidden; background-color: green; }
    </style>
</head>
<body>
    <div id="background-square" class="background-square"></div>
    <div id="background-line"></div>
    <div id="background-line2"></div>
    <div id="background-line3"></div>
    <div id="background-line4"></div>
    <div id="background-line5"></div>
    <div id="background-line6"></div>
    <div id="background-line7"></div>
    <div id="background-line8"></div>
    <div id="background-line9"></div>
    <div id="background-line10"></div>
    <div id="background-line11"></div>
    <div id="background-line12"></div>
    <div id="background-line13"></div>
    <div id="background-line14"></div>
    <div id="background-line15"></div>
    <div id="background-line16"></div>
    <div id="background-line17"></div>
    <div id="flamengo-circlecentral" class="circlecentral-flamengo"></div>
    <div id="gol-square" class="gol-square"></div>
    <div id="gol2-square" class="gol2-square"></div>
    <!-- Flamengo team circles, 1-11 (pink/green), 13-23 (red), 24 (white) -->
    <div id="flamengo-circle1" class="circle-flamengo">1</div>
    <div id="flamengo-circle2" class="circle-flamengo">2</div>
    <div id="flamengo-circle3" class="circle-flamengo">3</div>
    <div id="flamengo-circle4" class="circle-flamengo">4</div>
    <div id="flamengo-circle5" class="circle-flamengo">5</div>
    <div id="flamengo-circle6" class="circle-flamengo">6</div>
    <div id="flamengo-circle7" class="circle-flamengo">7</div>
    <div id="flamengo-circle8" class="circle-flamengo">8</div>
    <div id="flamengo-circle9" class="circle-flamengo">9</div>
    <div id="flamengo-circle10" class="circle-flamengo">10</div>
    <div id="flamengo-circle11" class="circle-flamengo">11</div>
    <div id="flamengo-circle13" class="circle-flamengo" style="background: #ff3333;">1</div>
    <div id="flamengo-circle14" class="circle-flamengo" style="background: #ff3333;">2</div>
    <div id="flamengo-circle15" class="circle-flamengo" style="background: #ff3333;">3</div>
    <div id="flamengo-circle16" class="circle-flamengo" style="background: #ff3333;">4</div>
    <div id="flamengo-circle17" class="circle-flamengo" style="background: #ff3333;">5</div>
    <div id="flamengo-circle18" class="circle-flamengo" style="background: #ff3333;">6</div>
    <div id="flamengo-circle19" class="circle-flamengo" style="background: #ff3333;">7</div>
    <div id="flamengo-circle20" class="circle-flamengo" style="background: #ff3333;">8</div>
    <div id="flamengo-circle21" class="circle-flamengo" style="background: #ff3333;">9</div>
    <div id="flamengo-circle22" class="circle-flamengo" style="background: #ff3333;">10</div>
    <div id="flamengo-circle23" class="circle-flamengo" style="background: #ff3333;">11</div>
    <div id="flamengo-circle24" class="circle-flamengo" style="background: #ffffff;"></div>
    <div id="fullscreen-overlay" style="
        position: fixed; left:0; top:0; width:100vw; height:100vh; 
        background: rgba(0,0,0,0.7); color: #fff; 
        display: flex; align-items: center; justify-content: center; 
        z-index: 9999; font-size: 2em; cursor: pointer;">
        Toque para entrar na Mesa Tática
    </div>
<!-- Clube dos 13 Menu Overlay (same as index.html) -->
<div id="clube-menu-overlay" style="
    display:none; position:fixed; left:0; top:0; width:100vw; height:100vh;
    background:rgba(0,0,0,0.85); z-index:10001; flex-direction:column; align-items:center; justify-content:center;">
    <div style="background:#fff; color:#111; border-radius:12px; padding:30px 16px 16px 16px; min-width:280px; max-width:90vw;">
        <h2 style="text-align:center; margin-top:0;">Clube dos 13</h2>
        <ul style="list-style:none; padding:0; margin:0;">
             <li>
              <a class="clube-link" href="atleticomineiro.html" style="display:flex; align-items:center;">
                <img src="img/AtleticoMineiro.png" width="20" height="22" alt="Atlético Mineiro" style="margin-right:6px;"/>
                Atlético Mineiro
              </a>
            </li>
             <li>
              <a class="clube-link" href="bahia.html" style="display:flex; align-items:center;">
                <img src="img/Bahia.png" width="20" height="22" alt="Bahia" style="margin-right:6px;"/>
                Flamengo
              </a>
            </li>
             <li>
              <a class="clube-link" href="botafogo.html" style="display:flex; align-items:center;">
                <img src="img/Botafogo.png" width="20" height="22" alt="Botafogo" style="margin-right:6px;"/>
                Botafogo
              </a>
            </li>
             <li>
              <a class="clube-link" href="corinthians.html" style="display:flex; align-items:center;">
                <img src="img/Corinthians.png" width="20" height="22" alt="Corinthians" style="margin-right:6px;"/>
                Corinthians
              </a>
            </li>
             <li>
              <a class="clube-link" href="cruzeiro.html" style="display:flex; align-items:center;">
                <img src="img/Cruzeiro.png" width="20" height="22" alt="Cruzeiro" style="margin-right:6px;"/>
                Cruzeiro
              </a>
            </li>
             <li>
              <a class="clube-link" href="flamengo.html" style="display:flex; align-items:center;">
                <img src="img/Flamengo.png" width="20" height="22" alt="Flamengo" style="margin-right:6px;"/>
                Flamengo
              </a>
            </li>
             <li>
              <a class="clube-link" href="index.html" style="display:flex; align-items:center;">
                <img src="img/Guarani.png" width="20" height="22" alt="Guarani F.C." style="margin-right:6px;"/>
                Guarani F.C.
              </a>
            </li>
             <li>
              <a class="clube-link" href="gremio.html" style="display:flex; align-items:center;">
                <img src="img/Gremio.png" width="20" height="22" alt="Grêmio" style="margin-right:6px;"/>
                Grêmio
              </a>
            </li>
             <li>
              <a class="clube-link" href="internacional.html" style="display:flex; align-items:center;">
                <img src="img/Internacional.png" width="20" height="22" alt="Internacional" style="margin-right:6px;"/>
                Internacional
              </a>
            </li>
             <li>
              <a class="clube-link" href="palmeiras.html" style="display:flex; align-items:center;">
                <img src="img/Palmeiras.png" width="20" height="22" alt="Palmeiras" style="margin-right:6px;"/>
                Palmeiras
              </a>
            </li>
             <li>
              <a class="clube-link" href="santos.html" style="display:flex; align-items:center;">
                <img src="img/Santos.png" width="20" height="22" alt="Santos" style="margin-right:6px;"/>
                Santos
              </a>
            </li>
             <li>
              <a class="clube-link" href="saopaulo.html" style="display:flex; align-items:center;">
                <img src="img/SaoPaulo.png" width="20" height="22" alt="São Paulo" style="margin-right:6px;"/>
                São Paulo
              </a>
            </li>
             <li>
              <a class="clube-link" href="vasco.html" style="display:flex; align-items:center;">
                <img src="img/Vasco.png" width="20" height="22" alt="Vasco da Gama" style="margin-right:6px;"/>
                Vasco da Gama
              </a>
            </li>
        </ul>
        <button id="close-clube-menu" style="
            display:block; margin:20px auto 0 auto; padding:8px 24px; font-size:1em; border-radius:8px; background:#222; color:#fff; border:none; cursor:pointer;">
            Fechar
        </button>
    </div>
</div>
<!-- Exit fullscreen button -->
    <button id="exit-fullscreen-btn" style="
        position: fixed;
        top: 380px; left: 20px;
        z-index: 10000;
        font-size: 1.2em;
        padding: 10px 18px;
        border-radius: 8px;
        background: #222; color: #fff;
        border: none;
        cursor: pointer;
        display: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    ">Sair (x)</button>
    <button id="clube-dos-13" style="
        position: fixed;
        top: 380px; left: 120px;
        z-index: 10000;
        font-size: 1.2em;
        padding: 10px 18px;
        border-radius: 8px;
        background: #222; color: #fff;
        border: none;
        cursor: pointer;
        display: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    ">Clube dos 13</button>
    <button id="sala-trofeus-btn" style="
        position: fixed;
        top: 380px; left: 272px;
        z-index: 10000;
        font-size: 1.2em;
        padding: 10px 18px;
        border-radius: 8px;
        background: #222; color: #fff;
        border: none;
        cursor: pointer;
        display: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    ">Sala de Troféus</button>
<script>
    // Show/hide Sala de Troféus button on fullscreen change (just like Clube dos 13)
    function updateButtonSalaTrofeus() {
        const btn = document.getElementById('sala-trofeus-btn');
        if (
            document.fullscreenElement ||
            document.webkitFullscreenElement ||
            document.msFullscreenElement
        ) {
            btn.style.display = 'block';
        } else {
            btn.style.display = 'none';
        }
    }
    document.addEventListener('fullscreenchange', updateButtonSalaTrofeus);
    document.addEventListener('webkitfullscreenchange', updateButtonSalaTrofeus);
    document.addEventListener('msfullscreenchange', updateButtonSalaTrofeus);

    document.getElementById('sala-trofeus-btn').addEventListener('click', function() {
        alert('Abrir Sala de Troféus!');
    });
    document.getElementById('sala-trofeus-btn').addEventListener('click', function() {
        window.location.href = "trofeus.html";
    });
    document.getElementById('clube-dos-13').addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('clube-menu-overlay').style.display = 'flex';
    });
    document.getElementById('close-clube-menu').addEventListener('click', function() {
        document.getElementById('clube-menu-overlay').style.display = 'none';
    });
    document.getElementById('clube-menu-overlay').addEventListener('click', function(e) {
        if (e.target === this) {
            this.style.display = 'none';
        }
    }); 
    document.getElementById('fullscreen-overlay').addEventListener('click', async function() {
        const el = document.documentElement;
        if (el.requestFullscreen) {
            await el.requestFullscreen();
        } else if (el.webkitRequestFullscreen) {
            await el.webkitRequestFullscreen();
        } else if (el.msRequestFullscreen) {
            await el.msRequestFullscreen();
        }
        if (screen.orientation && screen.orientation.lock) {
            try {
                await screen.orientation.lock('landscape');
            } catch (e) {}
        }
        document.getElementById('fullscreen-overlay').style.display = 'none';
    });
    function updateExitButton() {
        const btn = document.getElementById('exit-fullscreen-btn');
        if (
            document.fullscreenElement ||
            document.webkitFullscreenElement ||
            document.msFullscreenElement
        ) {
            btn.style.display = 'block';
        } else {
            btn.style.display = 'none';
        }
    }
    function updateButtonClube() {
        const btn = document.getElementById('clube-dos-13');
        if (
            document.fullscreenElement ||
            document.gotoAndPlayClubeList
        ) {
            btn.style.display = 'block';
        } else {
            btn.style.display = 'none';
        }
    }
    document.addEventListener('fullscreenchange', updateExitButton);
    document.addEventListener('webkitfullscreenchange', updateExitButton);
    document.addEventListener('msfullscreenchange', updateExitButton);
    document.addEventListener('fullscreenchange', updateButtonClube);
    document.getElementById('exit-fullscreen-btn').addEventListener('click', async function() {
        if (document.exitFullscreen) {
            await document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
            await document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
            await document.msExitFullscreen();
        }
        if (screen.orientation && screen.orientation.unlock) {
            try {
                await screen.orientation.unlock();
            } catch (e) {}
        }
    });
    document.getElementById('clube-dos-13').addEventListener('click', async function() {
        if (document.exitFullscreen) {
            await document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
            await document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
            await document.msExitFullscreen();
        }
        if (screen.orientation && screen.orientation.unlock) {
            try {
                await screen.orientation.unlock();
            } catch (e) {}
        }
    });
</script>
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
<script>
    const socket = io('https://mesatatica.onrender.com');
    // Unique Flamengo circles
    const circles = {};
    const dragState = {};
    // Use IDs flamengo-circle1 ... flamengo-circle24
    for (let i = 1; i <= 24; i++) {
        const el = document.getElementById('flamengo-circle' + i);
        circles[i] = el;
        dragState[i] = {
            dragging: false,
            offsetX: 0,
            offsetY: 0,
            lastReceived: 0
        };
        el.addEventListener('mousedown', (e) => {
            dragState[i].dragging = true;
            dragState[i].offsetX = e.offsetX;
            dragState[i].offsetY = e.offsetY;
            dragState[i].active = true;
            dragState[i].touch = false;
            window.activeCircleId = i;
        });
        el.addEventListener('touchstart', (e) => {
            dragState[i].dragging = true;
            const touch = e.touches[0];
            const rect = el.getBoundingClientRect();
            dragState[i].offsetX = touch.clientX - rect.left;
            dragState[i].offsetY = touch.clientY - rect.top;
            dragState[i].active = true;
            dragState[i].touch = true;
            window.activeCircleId = i;
            e.preventDefault();
        }, { passive: false });
    }
    document.addEventListener('mousemove', (e) => {
        for (let i = 1; i <= 24; i++) {
            if (dragState[i].dragging && !dragState[i].touch && window.activeCircleId === i) {
                let x = e.clientX - dragState[i].offsetX;
                let y = e.clientY - dragState[i].offsetY;
                let ts = Date.now();
                circles[i].style.left = x + 'px';
                circles[i].style.top = y + 'px';
                socket.emit('move_circle', { x, y, ts, id: 'flamengo-' + i });
            }
        }
    });
    document.addEventListener('mouseup', () => {
        for (let i = 1; i <= 24; i++) {
            dragState[i].dragging = false;
            dragState[i].active = false;
        }
        window.activeCircleId = undefined;
    });
    document.addEventListener('touchmove', (e) => {
        for (let i = 1; i <= 24; i++) {
            if (dragState[i].dragging && dragState[i].touch && window.activeCircleId === i) {
                const touch = e.touches[0];
                let x = touch.clientX - dragState[i].offsetX;
                let y = touch.clientY - dragState[i].offsetY;
                let ts = Date.now();
                circles[i].style.left = x + 'px';
                circles[i].style.top = y + 'px';
                socket.emit('move_circle', { x, y, ts, id: 'flamengo-' + i });
                e.preventDefault();
            }
        }
    }, { passive: false });
    document.addEventListener('touchend', () => {
        for (let i = 1; i <= 24; i++) {
            dragState[i].dragging = false;
            dragState[i].active = false;
        }
        window.activeCircleId = undefined;
    });
    socket.on('update_circle', (data) => {
        if (!String(data.id).startsWith('flamengo-')) return;
        const i = parseInt(String(data.id).replace('flamengo-',''), 10);
        if (circles[i] && typeof data.ts === 'number' && data.ts >= dragState[i].lastReceived) {
            dragState[i].lastReceived = data.ts;
            circles[i].style.left = data.x + 'px';
            circles[i].style.top = data.y + 'px';
        }
    });
</script>
<img src="img/Flamengo.png" alt="Flamengo" style="
    position: fixed;
    right: 0;
    bottom: 0;
    width: 200px;
    height: auto;
    z-index: 9000;
    opacity: 0.85;
    pointer-events: none;
">
</body>
</html>