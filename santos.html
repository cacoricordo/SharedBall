<!DOCTYPE html>
<html>
<head>
    <title>Mesa Tática Compartilhada</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .background-square {  /* Gramado */
            position: absolute;
            left: 20px;
            top: 20px;
            width: 600px;
            height: 300px;
            background: #16c516;
            z-index: 0;
            border-radius: 8px;
        }
        #background-line { /* Linha superior */
            position: absolute;
            left: 22px;
            top: 22px;
            width: 596px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line2 { /* Linha inferior */
            position: absolute;
            left: 22px;
            top: 316px;
            width: 596px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line3 { /* Linha esquerda*/
            position: absolute;
            left: 22px;
            top: 22px;
            width: 2px;
            height: 296px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line4 { /* Linha direita */
            position: absolute;
            left: 616px;
            top: 22px;
            width: 2px;
            height: 296px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line5 { /* Linha central */
            position: absolute;
            left: 308px;
            top: 22px;
            width: 2px;
            height: 296px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line6 { /* Linha grande Área direita */
            position: absolute;
            left: 88px;
            top: 97px;
            width: 2px;
            height: 150px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line7 { /* Linha Pequena Área direita */
            position: absolute;
            left: 58px;
            top: 120px;
            width: 2px;
            height: 102px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line8 {
            position: absolute;
            left: 22px;
            top: 120px; /* Linha Pequena Área superior*/
            width: 36px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line9 {
            position: absolute;
            left: 22px;
            top: 220px; /* Linha Pequena Área inferior*/
            width: 36px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line10 {
            position: absolute;
            left: 552px;
            top: 97px; /* Linha Grande Área superior*/
            width: 66px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line11 {
            position: absolute;
            left: 22px;
            top: 245px; /* Linha Grande Área inferior*/
            width: 66px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line12{ /* Linha grande Área direita */
            position: absolute;
            left: 550px;
            top: 97px;
            width: 2px;
            height: 150px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line13 { /* Linha Pequena Área direita */
            position: absolute;
            left: 580px;
            top: 120px;
            width: 2px;
            height: 102px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line14 {
            position: absolute;
            left: 582px;
            top: 120px; /* Linha Pequena Área superior*/
            width: 36px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line15 {
            position: absolute;
            left: 582px;
            top: 220px; /* Linha Pequena Área inferior*/
            width: 36px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line16 {
            position: absolute;
            left: 22px;
            top: 97px; /* Linha Grande Área superior*/
            width: 66px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        #background-line17 {
            position: absolute;
            left: 552px;
            top: 245px; /* Linha Grande Área inferior*/
            width: 66px;
            height: 2px;
            background: #fff;
            z-index: 0;
            border-radius: 1px;
            pointer-events: none;
        }
        .gol-square {
            position: absolute;
            left: 10px;  /* Adjust to place the square under the circles */
            top: 135px;
            width: 10px;
            height: 70px;
            background: #ffffff;
            z-index: 0;
            border-radius: 8px;
        }
        .gol2-square {
            position: absolute;
            left: 620px;  /* Adjust to place the square under the circles */
            top: 135px;
            width: 10px;
            height: 70px;
            background: #ffffff;
            z-index: 0;
            border-radius: 8px;
        }
        .circlecentral {
            width: 140px; height: 140px;
            background: #33aaff; border-radius: 50%;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-weight: bold;
            font-family: sans-serif;
            font-size: 14px;
            user-select: none;
        }
        .circle {
            width: 26px; height: 26px;
            background: #33aaff; border-radius: 50%;
            position: absolute;
            cursor: grab;
            touch-action: none;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-weight: bold;
            font-family: sans-serif;
            font-size: 14px;
            user-select: none;
        }
        #circle1 { left: 25px; top: 160px; background: #ff33aa; }
        #circle2 { left: 160px; top: 270px; background: #33ff88; }
        #circle3 { left: 120px; top: 130px; background: #33ff88; }
        #circle4 { left: 120px; top: 200px; background: #33ff88; }
        #circle5 { left: 200px; top: 160px; background: #33ff88; }
        #circle6 { left: 160px; top: 40px; background: #33ff88; }
        #circle7 { left: 300px; top: 270px; background: #33ff88; }
        #circle8 { left: 260px; top: 160px; background: #33ff88; }
        #circle9 { left: 370px; top: 160px; background: #33ff88; }
        #circle10 { left: 230px; top: 120px; background: #33ff88; }
        #circle11 { left: 320px; top: 40px; background: #33ff88; }
        body { margin: 0; overflow: hidden; background-color: green; }
    </style>
</head>
<body>
    <div id="background-square" class="background-square"></div>
    <div id="background-line"></div>
    <div id="background-line2"></div>
    <div id="background-line3"></div>
    <div id="background-line4"></div>
    <div id="background-line5"></div>
    <div id="background-line6"></div>
    <div id="background-line7"></div>
    <div id="background-line8"></div>
    <div id="background-line9"></div>
    <div id="background-line10"></div>
    <div id="background-line11"></div>
    <div id="background-line12"></div>
    <div id="background-line13"></div>
    <div id="background-line14"></div>
    <div id="background-line15"></div>
    <div id="background-line16"></div>
    <div id="background-line17"></div>
<div id="circle12" class="circlecentral" style="
    background: transparent;
    left: 237px;
    top: 100px;
    border: 2px solid #ffffff;
    color: #ffffff;
"></div>
    <div id="gol-square" class="gol-square"></div>
    <div id="gol2-square" class="gol2-square"></div>
    <div id="circle25" class="circle">1</div>
    <div id="circle26" class="circle">2</div>
    <div id="circle27" class="circle">3</div>
    <div id="circle28" class="circle">4</div>
    <div id="circle29" class="circle">5</div>
    <div id="circle30" class="circle">6</div>
    <div id="circle31" class="circle">7</div>
    <div id="circle32" class="circle">8</div>
    <div id="circle33" class="circle">9</div>
    <div id="circle34" class="circle">10</div>
    <div id="circle35" class="circle">11</div>
    <div id="circle36" class="circle" style="background: #ff3333;">1</div>
    <div id="circle37" class="circle" style="background: #ff3333;">2</div>
    <div id="circle38" class="circle" style="background: #ff3333;">3</div>
    <div id="circle39" class="circle" style="background: #ff3333;">4</div>
    <div id="circle40" class="circle" style="background: #ff3333;">5</div>
    <div id="circle41" class="circle" style="background: #ff3333;">6</div>
    <div id="circle42" class="circle" style="background: #ff3333;">7</div>
    <div id="circle43" class="circle" style="background: #ff3333;">8</div>
    <div id="circle44" class="circle" style="background: #ff3333;">9</div>
    <div id="circle45" class="circle" style="background: #ff3333;">10</div>
    <div id="circle46" class="circle" style="background: #ff3333;">11</div>
    <div id="circle47" class="circle" style="background: #ffffff;"></div>
    <div id="fullscreen-overlay" style="
        position: fixed; left:0; top:0; width:100vw; height:100vh; 
        background: rgba(0,0,0,0.7); color: #fff; 
        display: flex; align-items: center; justify-content: center; 
        z-index: 9999; font-size: 2em; cursor: pointer;">
        Toque para entrar na Mesa Tática
    </div>
<!-- Clube dos 13 Menu Overlay -->
<div id="clube-menu-overlay" style="
    display:none; position:fixed; left:0; top:0; width:100vw; height:100vh;
    background:rgba(0,0,0,0.85); z-index:10001; flex-direction:column; align-items:center; justify-content:center;">
    <div style="background:#fff; color:#111; border-radius:12px; padding:30px 16px 16px 16px; min-width:280px; max-width:90vw;">
        <h2 style="text-align:center; margin-top:0;">Clube dos 13</h2>
        <ul style="list-style:none; padding:0; margin:0;">
             <li>
              <a class="clube-link" href="atleticomineiro.html" style="display:flex; align-items:center;">
                <img src="img/AtleticoMineiro.png" width="20" height="22" alt="Atlético Mineiro" style="margin-right:6px;"/>
                Atlético Mineiro
              </a>
            </li>
             <li>
              <a class="clube-link" href="bahia.html" style="display:flex; align-items:center;">
                <img src="img/Bahia.png" width="20" height="22" alt="Bahia" style="margin-right:6px;"/>
                Flamengo
              </a>
            </li>
             <li>
              <a class="clube-link" href="botafogo.html" style="display:flex; align-items:center;">
                <img src="img/Botafogo.png" width="20" height="22" alt="Botafogo" style="margin-right:6px;"/>
                Botafogo
              </a>
            </li>
             <li>
              <a class="clube-link" href="corinthians.html" style="display:flex; align-items:center;">
                <img src="img/Corinthians.png" width="20" height="22" alt="Corinthians" style="margin-right:6px;"/>
                Corinthians
              </a>
            </li>
             <li>
              <a class="clube-link" href="cruzeiro.html" style="display:flex; align-items:center;">
                <img src="img/Cruzeiro.png" width="20" height="22" alt="Cruzeiro" style="margin-right:6px;"/>
                Cruzeiro
              </a>
            </li>
             <li>
              <a class="clube-link" href="flamengo.html" style="display:flex; align-items:center;">
                <img src="img/Flamengo.png" width="20" height="22" alt="Flamengo" style="margin-right:6px;"/>
                Flamengo
              </a>
            </li>
             <li>
              <a class="clube-link" href="index.html" style="display:flex; align-items:center;">
                <img src="img/Guarani.png" width="20" height="22" alt="Guarani F.C." style="margin-right:6px;"/>
                Guarani F.C.
              </a>
            </li>
             <li>
              <a class="clube-link" href="gremio.html" style="display:flex; align-items:center;">
                <img src="img/Gremio.png" width="20" height="22" alt="Grêmio" style="margin-right:6px;"/>
                Grêmio
              </a>
            </li>
             <li>
              <a class="clube-link" href="internacional.html" style="display:flex; align-items:center;">
                <img src="img/Internacional.png" width="20" height="22" alt="Internacional" style="margin-right:6px;"/>
                Internacional
              </a>
            </li>
             <li>
              <a class="clube-link" href="palmeiras.html" style="display:flex; align-items:center;">
                <img src="img/Palmeiras.png" width="20" height="22" alt="Palmeiras" style="margin-right:6px;"/>
                Palmeiras
              </a>
            </li>
             <li>
              <a class="clube-link" href="santos.html" style="display:flex; align-items:center;">
                <img src="img/Santos.png" width="20" height="22" alt="Santos" style="margin-right:6px;"/>
                Santos
              </a>
            </li>
             <li>
              <a class="clube-link" href="saopaulo.html" style="display:flex; align-items:center;">
                <img src="img/SaoPaulo.png" width="20" height="22" alt="São Paulo" style="margin-right:6px;"/>
                São Paulo
              </a>
            </li>
             <li>
              <a class="clube-link" href="vasco.html" style="display:flex; align-items:center;">
                <img src="img/Vasco.png" width="20" height="22" alt="Vasco da Gama" style="margin-right:6px;"/>
                Vasco da Gama
              </a>
            </li>
        </ul>
        <button id="close-clube-menu" style="
            display:block; margin:20px auto 0 auto; padding:8px 24px; font-size:1em; border-radius:8px; background:#222; color:#fff; border:none; cursor:pointer;">
            Fechar
        </button>
    </div>
</div>
<!-- Exit fullscreen button -->
    <button id="exit-fullscreen-btn" style="
        position: fixed;
        top: 380px; left: 20px;
        z-index: 10000;
        font-size: 1.2em;
        padding: 10px 18px;
        border-radius: 8px;
        background: #222; color: #fff;
        border: none;
        cursor: pointer;
        display: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    ">Sair (x)</button>
    <button id="clube-dos-13" style="
        position: fixed;
        top: 380px; left: 120px;
        z-index: 10000;
        font-size: 1.2em;
        padding: 10px 18px;
        border-radius: 8px;
        background: #222; color: #fff;
        border: none;
        cursor: pointer;
        display: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    ">Clube dos 13</button>
<!-- New Sala de Troféus button (same style, different left position) -->
<button id="sala-trofeus-btn" style="
    position: fixed;
    top: 380px; left: 272px;
    z-index: 10000;
    font-size: 1.2em;
    padding: 10px 18px;
    border-radius: 8px;
    background: #222; color: #fff;
    border: none;
    cursor: pointer;
    display: none;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
">Sala de Troféus</button>
  <script>
    // Show/hide Sala de Troféus button on fullscreen change (just like Clube dos 13)
    function updateButtonSalaTrofeus() {
        const btn = document.getElementById('sala-trofeus-btn');
        if (
            document.fullscreenElement ||
            document.webkitFullscreenElement ||
            document.msFullscreenElement
        ) {
            btn.style.display = 'block';
        } else {
            btn.style.display = 'none';
        }
    }
    document.addEventListener('fullscreenchange', updateButtonSalaTrofeus);
    document.addEventListener('webkitfullscreenchange', updateButtonSalaTrofeus);
    document.addEventListener('msfullscreenchange', updateButtonSalaTrofeus);

    // (example action: open an alert, you can change this to show a modal, etc)
    document.getElementById('sala-trofeus-btn').addEventListener('click', function() {
        alert('Abrir Sala de Troféus!');
        // You can replace the above with your modal or navigation logic
    });
    document.getElementById('sala-trofeus-btn').addEventListener('click', function() {
        window.location.href = "trofeus.html";
    });
    // Show Clube dos 13 menu
    document.getElementById('clube-dos-13').addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('clube-menu-overlay').style.display = 'flex';
    });

    // Close Clube dos 13 menu
    document.getElementById('close-clube-menu').addEventListener('click', function() {
        document.getElementById('clube-menu-overlay').style.display = 'none';
    });

    // Optional: Hide menu if user clicks outside the menu box
    document.getElementById('clube-menu-overlay').addEventListener('click', function(e) {
        if (e.target === this) {
            this.style.display = 'none';
        }
    }); 
        // Enter Fullscreen
        document.getElementById('fullscreen-overlay').addEventListener('click', async function() {
            const el = document.documentElement;
            // Try fullscreen
            if (el.requestFullscreen) {
                await el.requestFullscreen();
            } else if (el.webkitRequestFullscreen) { /* Safari */
                await el.webkitRequestFullscreen();
            } else if (el.msRequestFullscreen) { /* IE11 */
                await el.msRequestFullscreen();
            }
            // Attempt to lock orientation to landscape
            if (screen.orientation && screen.orientation.lock) {
                try {
                    await screen.orientation.lock('landscape');
                } catch (e) {
                    // Some browsers might not support or allow it
                }
            }
            document.getElementById('fullscreen-overlay').style.display = 'none';
        });

        // Show/hide exit button on fullscreen change
        function updateExitButton() {
            const btn = document.getElementById('exit-fullscreen-btn');
            if (
                document.fullscreenElement ||
                document.webkitFullscreenElement ||
                document.msFullscreenElement
            ) {
                btn.style.display = 'block';
            } else {
                btn.style.display = 'none';
            }
        }

        // Show/hide clube button on fullscreen change
        function updateButtonClube() {
            const btn = document.getElementById('clube-dos-13');
            if (
                document.fullscreenElement ||
                document.gotoAndPlayClubeList
            ) {
                btn.style.display = 'block';
            } else {
                btn.style.display = 'none';
            }
        }

        document.addEventListener('fullscreenchange', updateExitButton);
        document.addEventListener('webkitfullscreenchange', updateExitButton);
        document.addEventListener('msfullscreenchange', updateExitButton);
        document.addEventListener('fullscreenchange', updateButtonClube);

        // Exit Fullscreen function
        document.getElementById('exit-fullscreen-btn').addEventListener('click', async function() {
            if (document.exitFullscreen) {
                await document.exitFullscreen();
            } else if (document.webkitExitFullscreen) { /* Safari */
                await document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE11 */
                await document.msExitFullscreen();
            }
            // Optionally unlock orientation if supported
            if (screen.orientation && screen.orientation.unlock) {
                try {
                    await screen.orientation.unlock();
                } catch (e) {}
            }
        });

        // Clube function
        document.getElementById('clube-dos-13').addEventListener('click', async function() {
            if (document.exitFullscreen) {
                await document.exitFullscreen();
            } else if (document.webkitExitFullscreen) { /* Safari */
                await document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE11 */
                await document.msExitFullscreen();
            }
            // Optionally unlock orientation if supported
            if (screen.orientation && screen.orientation.unlock) {
                try {
                    await screen.orientation.unlock();
                } catch (e) {}
            }
        });
    </script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        const socket = io('https://mesatatica.onrender.com');

        // Store state for all circles
        const circles = {};
        const dragState = {};

        for (let i = 1; i <= 24; i++) {
            const el = document.getElementById('circle' + i);
            circles[i] = el;
            dragState[i] = {
                dragging: false,
                offsetX: 0,
                offsetY: 0,
                lastReceived: 0
            };

            // Mouse events
            el.addEventListener('mousedown', (e) => {
                dragState[i].dragging = true;
                dragState[i].offsetX = e.offsetX;
                dragState[i].offsetY = e.offsetY;
                dragState[i].active = true;
                dragState[i].touch = false;
                window.activeCircleId = i;
            });

            // Touch events
            el.addEventListener('touchstart', (e) => {
                dragState[i].dragging = true;
                const touch = e.touches[0];
                const rect = el.getBoundingClientRect();
                dragState[i].offsetX = touch.clientX - rect.left;
                dragState[i].offsetY = touch.clientY - rect.top;
                dragState[i].active = true;
                dragState[i].touch = true;
                window.activeCircleId = i;
                e.preventDefault();
            }, { passive: false });
        }

        // Mouse move
        document.addEventListener('mousemove', (e) => {
            for (let i = 1; i <= 24; i++) {
                if (dragState[i].dragging && !dragState[i].touch && window.activeCircleId === i) {
                    let x = e.clientX - dragState[i].offsetX;
                    let y = e.clientY - dragState[i].offsetY;
                    let ts = Date.now();
                    circles[i].style.left = x + 'px';
                    circles[i].style.top = y + 'px';
                    socket.emit('move_circle', { x, y, ts, id: i });
                }
            }
        });

        // Mouse up
        document.addEventListener('mouseup', () => {
            for (let i = 1; i <= 24; i++) {
                dragState[i].dragging = false;
                dragState[i].active = false;
            }
            window.activeCircleId = undefined;
        });

        // Touch move
        document.addEventListener('touchmove', (e) => {
            for (let i = 1; i <= 24; i++) {
                if (dragState[i].dragging && dragState[i].touch && window.activeCircleId === i) {
                    const touch = e.touches[0];
                    let x = touch.clientX - dragState[i].offsetX;
                    let y = touch.clientY - dragState[i].offsetY;
                    let ts = Date.now();
                    circles[i].style.left = x + 'px';
                    circles[i].style.top = y + 'px';
                    socket.emit('move_circle', { x, y, ts, id: i });
                    e.preventDefault();
                }
            }
        }, { passive: false });

        // Touch end
        document.addEventListener('touchend', () => {
            for (let i = 1; i <= 24; i++) {
                dragState[i].dragging = false;
                dragState[i].active = false;
            }
            window.activeCircleId = undefined;
        });

        // Listen for updates for all circles
        socket.on('update_circle', (data) => {
            const i = data.id;
            if (circles[i] && typeof data.ts === 'number' && data.ts >= dragState[i].lastReceived) {
                dragState[i].lastReceived = data.ts;
                circles[i].style.left = data.x + 'px';
                circles[i].style.top = data.y + 'px';
            }
        });
    </script>
<img src="img/Guarani.png" alt="Guarani F.C." style="
    position: fixed;
    right: 0;
    bottom: 0;
    width: 200px;    /* Adjust size as needed */
    height: auto;
    z-index: 9000;   /* Below overlays but above field */
    opacity: 0.85;   /* Optional: subtle transparency */
    pointer-events: none; /* Prevents blocking clicks */
">
</body>
</html>
